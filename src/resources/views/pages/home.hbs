<style>
    /* Điều chỉnh tốc độ và kiểu chuyển slide */
    .carousel-item {
        transition: transform 1s ease; /* Thêm hiệu ứng mượt mà */
    }

    /* Cải thiện hiệu ứng chuyển động từ trái sang phải */
    .carousel-control-prev-icon, .carousel-control-next-icon {
        background-color: black; /* Đổi màu biểu tượng chuyển */
    }

</style>
<div id="carouselExampleIndicators" class="carousel slide slideshow">
  <div class="carousel-indicators">
    <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
    <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1" aria-label="Slide 2"></button>
    <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2" aria-label="Slide 3"></button>
    <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="3" aria-label="Slide 4"></button>
  </div>
  <div class="carousel-inner">
    <div class="carousel-item active">
        <div class="row slideshow-row">
            <div class="col-sm-6">
                <span class="slideshow-title">Thành Quả của Học Viên</span>
                <span class="slideshow-description">
                    Để đạt được kết quả tốt trong mọi việc ta cần xác định mục tiêu rõ ràng cho việc đó. Lập trình cũng không ngoại lệ. 
                </span>
                <button class="slideshow-button" id="learn-now-button">Học Ngay</button>
            </div>
            <div class="col-sm-4">
              <img src="https://files.fullstack.edu.vn/f8-prod/banners/Banner_01_2.png" class="d-block w-100" alt="...">
            </div>
        </div>
    </div>
    <div class="carousel-item">
      <div class="row slideshow-row">
            <div class="col-sm-6">
                <span class="slideshow-title">Học ReactJs Miễn Phí!</span>
                <span class="slideshow-description">
                    Khoá học ReactJS từ cơ bản tới nâng cao. Kết quả của khoá học này là bạn có thể làm hầu hết các dự án với ReactJS.
                </span>
                <button class="slideshow-button" id="learn-now-button">Đăng ký ngay</button>
            </div>
            <div class="col-sm-4">
              <img src="https://files.fullstack.edu.vn/f8-prod/banners/Banner_web_ReactJS.png" class="d-block w-100" alt="...">
            </div>
        </div>
    </div>
    <div class="carousel-item">
      <div class="row slideshow-row">
            <div class="col-sm-6">
                <span class="slideshow-title">Lớp Offline tại TVU</span>
                <span class="slideshow-description">
                    Hình thức học Offline phù hợp nếu bạn muốn được hướng dẫn và hỗ trợ trực tiếp tại lớp. Giờ học linh hoạt, phù hợp cả sinh viên và người đi làm.
                </span>
                <button class="slideshow-button" id="learn-now-button">Đăng ký ngay</button>
            </div>
            <div class="col-sm-4">
              <img src="https://files.fullstack.edu.vn/f8-prod/banners/36/6454dee96205c.png" class="d-block w-100" alt="...">
            </div>
        </div>
    </div>
    <div class="carousel-item">
      <div class="row slideshow-row">
            <div class="col-sm-6">
                <span class="slideshow-title">Học HTML CSS cho người mới</span>
                <span class="slideshow-description">
                    Thực hành dự án với Figma, hàng trăm bài tập và thử thách, hướng dẫn 100% bởi Huệ Trung, tặng kèm Flashcards, v.v.
                </span>
                <button class="slideshow-button" id="learn-now-button">Đăng ký ngay</button>
            </div>
            <div class="col-sm-4">
              <img src="https://files.fullstack.edu.vn/f8-prod/banners/20/6308a6bf603a4.png" class="d-block w-100" alt="...">
            </div>
        </div>
    </div>
  </div>
  <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Previous</span>
  </button>
  <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="visually-hidden">Next</span>
  </button>
</div>

<div class="container cousrse">
    <div class="cousrse-title">
        <form class="d-flex form-search" role="search" action="/Search" method="get">
            <select class="form-control filter" name="level">
                <option value="">Tất cả trình độ</option>
                <option value="Beginner">Beginner</option>
                <option value="Intermediate">Intermediate</option>
                <option value="Advanced">Advanced</option>
            </select>
            <select class="form-control filter" name="category">
                <option value="">Tất cả lĩnh vực</option>
                <option value="Programming">Programming</option>
                <option value="Design">Design</option>
                <option value="Marketing">Marketing</option>
            </select>
            <button class="btn btn-outline-search" type="submit">Tìm kiếm</button>
        </form>

    </div>
    <div class="cousrse-title">
        <h1 class="text-course">Khoá học Pro</h1>
        <img class="img-course" src="/img/new.png" alt="">
    </div>
    <div class="row list-courses">
        {{#each courses}}
            {{#if this.newPrice}}
                <div class="col-sm mb-4">
                    <a href="/Course/{{this._id}}" class="card" style="width: 18rem;" onclick="">
                        <img src="{{this.image}}" class="card-img-top" alt="...">
                        <div class="card-body">
                            <h5 class="card-title">{{this.name}}</h5>
                            <div class="card-price d-flex">
                                <p class="card-text-old ">{{this.oldPrice}}.000 đ</p>
                                <p class="card-text">{{this.newPrice}}.000 đ</p>
                            </div>
                            <div class="card-bottom d-flex">
                                <div class="author">
                                    <img style="border-radius: 50%; width: 30px; height: 30px;" src="{{this.imageAuthor}}" alt="">
                                    <span>{{this.author}}</span>
                                </div>
                                <div class="number-course">
                                    <img src="/img/success.png" alt="">
                                    <span>{{this.totalLessons}} Bài học</span>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
                {{/if}}
        {{/each}}
    </div>
    <div class="cousrse-title">
        <h1 class="text-course">Khoá học miễn phí</h1>
        <img class="img-course" src="/img/free.png" alt="">
    </div>
    <div class="row list-courses">
        {{#each courses}}
            {{#if (isPriceZero this.newPrice)}}
                <div class="col-sm mb-4">
                    <a href="/Course/{{this._id}}" class="card" style="width: 18rem;" onclick="">
                        <img src="{{this.image}}" class="card-img-top" alt="...">
                        <div class="card-body">
                            <h5 class="card-title">{{this.name}}</h5>
                            <div class="card-price d-flex">
                                <p class="card-text">miễn phí</p>
                            </div>
                            <div class="card-bottom d-flex">
                                <div class="author">
                                    <img style="border-radius: 50%; width: 30px; height: 30px;" src="{{this.imageAuthor}}" alt="">
                                    <span>{{this.author}}</span>
                                </div>
                                <div class="number-course">
                                    <img src="/img/success.png" alt="">
                                    <span>{{this.totalLessons}} Bài học</span>
                                </div>
                            </div>
                        </div>
                    </a>
                </div>
                {{/if}}
        {{/each}}
    </div>
</div>

<script>
    const isLoggedInUser = {{#if isLoggedInUser}}true{{else}}false{{/if}};

     /**
     * Hàm xử lý nút "Học Ngay"
     * @param {Event} event - Sự kiện click
     * @param {string} courseId - ID của khóa học
     */
    function handleLearnNow(event, courseId) {
        event.preventDefault(); // Ngăn hành động mặc định của nút (nếu có)

        if (!isLoggedInUser) {
            // Nếu người dùng chưa đăng nhập, hiển thị SweetAlert và chuyển hướng đến trang đăng nhập
            const currentUrl = window.location.href;
            Swal.fire({
                title: 'Bạn chưa đăng nhập!',
                text: 'Bạn cần đăng nhập để đăng ký khóa học.',
                icon: 'warning',
                showCancelButton: true,
                confirmButtonColor: '#3085d6',
                cancelButtonColor: '#d33',
                confirmButtonText: 'Đăng nhập',
                cancelButtonText: 'Hủy bỏ'
            }).then((result) => {
                if (result.isConfirmed) {
                    // Chuyển hướng đến trang đăng nhập với tham số redirect
                    window.location.href = `/User/Login/`;
                }
            });
        } else {
            // Nếu người dùng đã đăng nhập, chuyển hướng đến trang học khóa học
            {{!-- window.location.href = `/courses/${courseId}`; --}}
        }
    }

    // Gán sự kiện click cho tất cả các nút "Học Ngay" sau khi DOM đã tải xong
    document.addEventListener('DOMContentLoaded', () => {
        // Lấy phần tử carousel
        const carouselElement = document.getElementById('carouselExampleIndicators');
        
        // Tạo một interval để chuyển slide tự động sau 3 giây (3000ms)
        setInterval(() => {
            const carousel = new bootstrap.Carousel(carouselElement, {
                interval: 3000,  // thời gian chuyển slide
                ride: 'carousel'  // tự động chạy carousel khi trang được tải
            });
            
            carousel.next(); // Chuyển sang slide tiếp theo
        }, 3000); // Mỗi 3 giây
        const learnNowButtons = document.querySelectorAll('.slideshow-button');

        learnNowButtons.forEach(button => {
            const courseId = button.getAttribute('data-course-id');
            button.addEventListener('click', (e) => handleLearnNow(e, courseId));
        });
    });
</script>

<script>
    function DangPhatTrien() {
        Swal.fire({
            title: 'Tính năng đang phát triển!',
            text: 'Huệ Trung sẽ sớm cập nhật tính năng này.',
            icon: 'info',
            confirmButtonText: 'Đóng'
        });
        return false; // Ngăn form submit hoặc hành động mặc định
    }
    document.addEventListener("DOMContentLoaded", function () { 
        const isDeletedCourse = {{#if isDeletedCourse}}true{{else}}false{{/if}};
        if(isDeletedCourse) {
            Swal.fire({
                title: 'Khóa học đã bị vô hiệu hóa!',
                text: 'Khóa học đã bị vô hiệu hóa, vui lòng quay lại sau.',
                icon: 'info',
                confirmButtonText: 'OK'
            }).then((result) => {
            if (result.isConfirmed) {
                history.back();
            }
        });
        }
    });
</script>

